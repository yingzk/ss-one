(function(_0xa61b71,_0x4a376a){const _0x57ae14=_0x1f4f,_0x5dcbcd=_0xa61b71();while(!![]){try{const _0x26825c=-parseInt(_0x57ae14(0x20e))/0x1*(parseInt(_0x57ae14(0x21f))/0x2)+-parseInt(_0x57ae14(0x224))/0x3*(-parseInt(_0x57ae14(0x200))/0x4)+-parseInt(_0x57ae14(0x214))/0x5*(parseInt(_0x57ae14(0x215))/0x6)+-parseInt(_0x57ae14(0x213))/0x7+-parseInt(_0x57ae14(0x1ff))/0x8+-parseInt(_0x57ae14(0x226))/0x9*(-parseInt(_0x57ae14(0x221))/0xa)+-parseInt(_0x57ae14(0x1fc))/0xb;if(_0x26825c===_0x4a376a)break;else _0x5dcbcd['push'](_0x5dcbcd['shift']());}catch(_0x32eaac){_0x5dcbcd['push'](_0x5dcbcd['shift']());}}}(_0x25c2,0x2b986));import{CONFIG}from'./config.js';function _0x1f4f(_0x5b867f,_0x579ca4){const _0x25c28e=_0x25c2();return _0x1f4f=function(_0x1f4f04,_0x1a98f0){_0x1f4f04=_0x1f4f04-0x1f3;let _0x1cec82=_0x25c28e[_0x1f4f04];return _0x1cec82;},_0x1f4f(_0x5b867f,_0x579ca4);}import{NodesService,CollectionsService,ShareService,AuthService,UserService}from'./services.js';import{generateManagementPage}from'./management.js';import{isSubscriptionPath}from'./utils.js';function _0x25c2(){const _0x3d1d0c=['Bearer\x20','share','API','Not\x20Found','expiry','172FAjiHI','url','630VNhdeO','searchParams','handleLogin','9DFPvSS','/favicon.ico','42093sqSRdb','LOGIN','secret','verifySession','collectionId','SHARE','Authorization','GET,\x20POST,\x20PUT,\x20DELETE,\x20OPTIONS','OPTIONS','username','split','1415799IVNsDM','method','get','398784qBsnQO','467044ncDtlp','user','checkAuth','application/json','pathname','startsWith','headers','token','NODES','USER','handleRequest','COLLECTIONS','Content-Type,\x20Authorization','Unauthorized','272xIEdFR','Basic\x20realm=\x22Admin\x20Access\x22','deleteSession','/user','PAGE','113043qUzjgm','55cYSTrf','135420hdNDyi','nodes','/api/','86400','handle'];_0x25c2=function(){return _0x3d1d0c;};return _0x25c2();}import{ErrorHandler}from'./middleware.js';import{generateUserPage}from'./user.js';export default{async 'fetch'(_0x48d013,_0x1d0515,_0x576351){const _0x39afb1=_0x1f4f;try{const _0x21c317=initializeServices(_0x1d0515);return await handleRequest(_0x48d013,_0x1d0515,_0x21c317);}catch(_0x37cacd){return ErrorHandler[_0x39afb1(0x219)](_0x37cacd,_0x48d013);}}};function initializeServices(_0x90c574){const _0x1d913d=new NodesService(_0x90c574,CONFIG),_0x4613ae=new CollectionsService(_0x90c574,CONFIG),_0x137493=new ShareService(_0x90c574,CONFIG,_0x1d913d,_0x4613ae),_0x195499=new UserService(_0x90c574,CONFIG),_0x5781e9=new AuthService(_0x90c574,CONFIG);return{'nodes':_0x1d913d,'collections':_0x4613ae,'share':_0x137493,'user':_0x195499,'auth':_0x5781e9};}async function handleRequest(_0x59c41b,_0x3929c0,_0x5ccaf0){const _0x171e56=_0x1f4f,_0x45c9e1=new URL(_0x59c41b['url']),_0x487125=_0x45c9e1[_0x171e56(0x204)],_0x49dad9=_0x59c41b[_0x171e56(0x1fd)];if(_0x49dad9===_0x171e56(0x1f9))return handleCORS();if(_0x487125==='/favicon.ico')return new Response(null,{'status':0xcc});if(_0x487125['startsWith'](CONFIG[_0x171e56(0x21c)][_0x171e56(0x209)][_0x171e56(0x212)]))try{let _0xc2dcc=_0x59c41b[_0x171e56(0x206)][_0x171e56(0x1fe)](_0x171e56(0x1f7));const _0x21e44e=new URL(_0x59c41b[_0x171e56(0x220)]),_0x93360c=_0x21e44e[_0x171e56(0x222)][_0x171e56(0x1fe)]('token');_0x93360c&&(_0xc2dcc=_0x171e56(0x21a)+_0x93360c);if(_0xc2dcc?.[_0x171e56(0x205)](_0x171e56(0x21a))){const _0x3c367a=_0xc2dcc[_0x171e56(0x1fb)]('\x20')[0x1],_0x177d39=await _0x5ccaf0[_0x171e56(0x201)][_0x171e56(0x1f4)](_0x3c367a,_0x59c41b);if(_0x177d39)return generateUserPage(_0x3929c0,_0x171e56(0x1f3),{'username':_0x177d39[_0x171e56(0x1fa)],'collectionId':_0x177d39[_0x171e56(0x1f5)],'expiry':_0x177d39[_0x171e56(0x21e)],'request':_0x59c41b});}return generateUserPage(_0x3929c0);}catch(_0x3cb4df){return ErrorHandler['handle'](_0x3cb4df,_0x59c41b);}if(isPublicPath(_0x487125)){if(_0x487125[_0x171e56(0x205)](_0x171e56(0x217)))return handleAPIRequest(_0x59c41b,_0x487125,_0x5ccaf0);return null;}const _0x55110f=_0x59c41b[_0x171e56(0x206)][_0x171e56(0x1fe)]('Authorization');if(!_0x55110f||!_0x5ccaf0['auth'][_0x171e56(0x202)](_0x55110f))return new Response(_0x171e56(0x20d),{'status':0x191,'headers':{'WWW-Authenticate':_0x171e56(0x20f),'Access-Control-Allow-Origin':'*'}});if(_0x487125[_0x171e56(0x205)](_0x171e56(0x217)))return handleAPIRequest(_0x59c41b,_0x487125,_0x5ccaf0);return generateManagementPage(_0x3929c0,CONFIG);}function isPublicPath(_0x170571){const _0xdc8c39=_0x1f4f;return _0x170571[_0xdc8c39(0x205)](CONFIG[_0xdc8c39(0x21c)][_0xdc8c39(0x1f6)])||isSubscriptionPath(_0x170571)||_0x170571[_0xdc8c39(0x205)](_0xdc8c39(0x211))||_0x170571[_0xdc8c39(0x205)](CONFIG[_0xdc8c39(0x21c)][_0xdc8c39(0x209)]['BASE'])||_0x170571===_0xdc8c39(0x225);}function handleCORS(){const _0x542e0a=_0x1f4f;return new Response(null,{'headers':{'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x542e0a(0x1f8),'Access-Control-Allow-Headers':_0x542e0a(0x20c),'Access-Control-Max-Age':_0x542e0a(0x218)}});}async function handleAPIRequest(_0x3d4348,_0x111150,_0x58adb5){const _0x155579=_0x1f4f;if(_0x111150[_0x155579(0x205)](CONFIG[_0x155579(0x21c)][_0x155579(0x1f6)]))return _0x58adb5[_0x155579(0x21b)][_0x155579(0x20a)](_0x3d4348);if(_0x111150[_0x155579(0x205)](CONFIG[_0x155579(0x21c)][_0x155579(0x209)]['BASE'])){if(_0x111150===CONFIG['API'][_0x155579(0x209)][_0x155579(0x227)])return _0x58adb5[_0x155579(0x201)][_0x155579(0x223)](_0x3d4348);if(_0x111150===CONFIG['API'][_0x155579(0x209)]['LOGOUT']){const _0xba68f=new URL(_0x3d4348[_0x155579(0x220)]),_0xa61a5e=_0xba68f['searchParams']['get'](_0x155579(0x207));return _0xa61a5e&&await _0x58adb5[_0x155579(0x201)][_0x155579(0x210)](_0xa61a5e),new Response(JSON['stringify']({'success':!![]}),{'headers':{'Content-Type':_0x155579(0x203)}});}return _0x58adb5[_0x155579(0x201)][_0x155579(0x20a)](_0x3d4348);}if(_0x111150[_0x155579(0x205)](CONFIG[_0x155579(0x21c)][_0x155579(0x208)]))return _0x58adb5[_0x155579(0x216)]['handleRequest'](_0x3d4348);if(_0x111150['startsWith'](CONFIG[_0x155579(0x21c)][_0x155579(0x20b)]))return _0x58adb5['collections'][_0x155579(0x20a)](_0x3d4348);return new Response(_0x155579(0x21d),{'status':0x194});}
